"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[826],{8361:(e,t,n)=>{n.d(t,{Z:()=>o});const o=function(){const e=[{url:"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css",type:"link"},{url:"https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css",type:"link"},{url:"./assets/main.css",type:"link"}];return{load:function(t){var n;(n=e.map((function({url:e,type:t}){return function(e,t){return new Promise((function(n,o){if("script"!==t&&"link"!==t)throw"not a valid type for load func!";let a=document.createElement(t);"script"===t&&(a.src=e),"link"===t&&(a.setAttribute("rel","stylesheet"),a.setAttribute("href",e)),a.addEventListener("load",(function(){n(!0)})),document.head.appendChild(a)}))}(e,t)})),n.reduce((function(e,t){return e.then((function(){return t.then((function(e){return!0}))}))}),Promise.resolve([]))).then((e=>{console.log("Done loading Core!"),t&&t()}))}}}()},1696:(e,t,n)=>{n.d(t,{q:()=>o});const o={getNowSeconds:()=>Math.round((new Date).getTime()/1e3),getRemainingHours:e=>Math.round((e-o.getNowSeconds())/60/60),getRemainingMinutes:e=>Math.round((e-o.getNowSeconds())/60),getRemainingSeconds:e=>Math.round(e-o.getNowSeconds()),stillInAdventure:e=>Math.round(e-o.getNowSeconds())>0}},2521:(e,t,n)=>{n.d(t,{QD:()=>o,u_:()=>s,Kr:()=>a});const o=function(){function e(e){s.clearModal();const t=`<p>${e}</p>`;s.populateModal("Error Message",t,""),s.show()}return{login:function(){const t={username:prompt("Your Username:",""),password:prompt("Your Password:","")};fetch("/auth/login",{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},referrerPolicy:"no-referrer",body:JSON.stringify(t)}).then((t=>{200!==t.status&&e("Error while processing this request!"),!0===t.redirected&&(document.location.href=t.url)})).catch((t=>{e(t),console.log("err",t)}))},logout:function(){document.location.href="/auth/logout"},register:function(){const e=document.getElementById("username").value,t=document.getElementById("password").value;fetch("/auth/register",{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({username:e,password:t})}).then((e=>e.json())).then((e=>{e.error?(s.clearModal(),s.populateModal("Error",`Server responded with: <u>${e.error}</u>`,""),s.show()):(s.clearModal(),s.populateModal("Notification","You have been successfully registered!",""),s.show())})).catch((e=>e.json()))}}}(),a=new class{state={};set=e=>{this.state={...this.state,...e},this.fire(this.state)};get=()=>this.state;subscribers=[];subscribeAll=e=>{for(const t of e){const{fn:e,that:n}=t;this.subscribe(e,n)}};subscribe=(e,t=null)=>{this.subscribers.push({fn:e,that:t})};fire=e=>{this.subscribers.forEach((({fn:t,that:n})=>{t.call(n,e)}))}};var r=n(8563);!function(){const e="#loader_wrapper";!function(t=null){t?r(e).fadeOut("slow",t):r(e).fadeOut("slow")}()}();var i=n(8563);const s=function(){const e={isOpened:!1},t={ModalContent:"#ModalContent",ModalContainer:".modal_container",CloseModalBtn:".closeModalBtn",ModalTitle:"#modalTitle",ModalBtns:"#ModalBtns",Modal:"#modal"};function n(t){if("boolean"!=typeof t)throw new Error("Invalid type was passed to _setIsOpened function!!!");e.isOpened=!e.isOpened}function o(){i(t.ModalTitle).html(""),i(t.ModalContent).html(""),i(t.ModalBtns).html(""),r("default")}function a(e=null,o=null,...a){i(t.ModalContainer).fadeOut(700,(function(){n(!1),(e||o)&&("function"!=typeof e||o?e.apply(o,Array.prototype.slice.apply(arguments,[2,arguments.length-1])):e())}))}function r(e=null){i(t.Modal).hasClass("d-flex flex-column justify-content-center")&&i(t.Modal).removeClass("d-flex flex-column justify-content-center"),i(t.ModalContent).hasClass("d-flex flex-column justify-content-center align-items-center")&&i(t.ModalContent).removeClass("d-flex flex-column justify-content-center align-items-center"),i(t.ModalBtns).hasClass("d-flex justify-content-center flex-row")&&i(t.ModalBtns).removeClass("d-flex justify-content-center flex-row")}return i(t.ModalContainer).hide(),i("body").on("click",t.CloseModalBtn,(function(){a(o)})),!i(t.Modal).hasClass("p-4")&&i(t.Modal).addClass("p-4"),{hide:a,show:function(e=null){i(t.ModalContainer).fadeIn(700,(function(){n(!0),"function"==typeof e&&e()}))},clearModal:o,populateModal:function(e,n,o,a=!0){a?i(t.CloseModalBtn).show():i(t.CloseModalBtn).hide(),i(t.ModalTitle).html(e),i(t.ModalContent).html(n),i(t.ModalBtns).html(o)},getSelectors:function(){return t},hideAndClear:function(){i(t.ModalContainer).fadeOut(700,(function(){n(!1),o()}))},addAlert:function(e="warning",n="",o=""){const a=`\n      <div class="alert alert-${e} alert-dismissible fade show" role="alert">\n        <strong>${n}</strong> ${o}\n        <button type="button" class="close" data-dismiss="alert" aria-label="Close">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      `;i(t.ModalContent).prepend(a)},applyStyle:r,isOpened:function(){return e.isOpened}}}();n(1696)},4814:(e,t,n)=>{n(1283),n(7588);var o=n(8361),a=n(2521);const r=async function(e){const t=await fetch("/game/user/heroes/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()},i=async function(e){const t=await fetch("/game/user/heroes/claim",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()},s=async function(e=3){const t=await fetch(`/game/user/heroes/random?num=${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});return await t.json()},l=async function(e){const t={hero_id:e},n=await fetch("/game/user/heroes/buy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return await n.json()},c=async function(e){const t=await fetch("/game/user/items/sell",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()},d=async function(e){const t={record_id:e},n=await fetch("/game/user/items/buy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return await n.json()},u=async function(e=3){const t=await fetch(`/game/user/items/random?num=${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});return await t.json()};var m=n(1696),f=n(8563);const h=function(){const e={usernameInput:document.getElementById("usernameInput"),moneyBtn:f("#moneyBtn")};return{display:function({username:t,money:n}){document.getElementById("WelcomeHeader").textContent=`Welcome! \n${t}`,e.moneyBtn.html(`${n} <i class="bi bi-coin"></i>`)},getUsername:function(){return e.usernameInput.value},setUsername:function(t){e.usernameInput.value=t}}}(),p=new class{reload(){const e=[fetch("/profile"),fetch("/game/user/items"),fetch("/game/user/heroes")];Promise.all(e).then((e=>Promise.all(e.map((e=>e.json()))))).then((e=>{a.Kr.set({items:e[1],profile:e[0],heroes:e[2]})})).catch((e=>console.error(e)))}refetchHeroes(){fetch("/game/user/heroes").then((e=>e.json())).then((e=>{a.Kr.set({heroes:e})}))}refetchItems(){fetch("/game/user/items").then((e=>e.json())).then((e=>{a.Kr.set({items:e})}))}refetchProfile(){fetch("/profile").then((e=>e.json())).then((e=>{a.Kr.set({profile:e})}))}stateChanged({profile:e,items:t,heroes:n}){t&&this.itemsHandler(t),e&&this.profileHandler(e),n&&this.heroesHandler(n)}profileHandler(e){h.display(e),h.setUsername(e.username)}itemsHandler(e){C.displayItems(e)}heroesHandler(e){g.display(e)}};var b=n(8563);const g=function(){const e={heroesContainer:document.getElementById("heroes-container")};return{display:function(t){e.heroesContainer.innerHTML="",e.heroesContainer.insertAdjacentHTML("beforeend",t.map((e=>{return`\n    <div class="single-hero-box col-lg-3 col-md-6 col-sm-12">\n        <div class="hero-box-inner-details">\n            <img src='${(t=e).image}' class="img-thumbnail"/>\n            <p>${t.name}</p>\n            <small>${(({is_available:e,arrivalSeconds:t})=>e?"Resting at home...":!e&&m.q.stillInAdventure(t)?"Having an adventure...":"Waiting for you...")(t)}</small>\n        </div>\n        <div class="d-grid gap-2 mt-2">\n            ${(e=>{if(0===e.is_available&&m.q.stillInAdventure(e.arrivalSeconds)){const n=`${e.hero_record_id}_user_hero`;var t=setInterval((()=>{m.q.stillInAdventure(e.arrivalSeconds)?b(`#${n}`).text(`Arrives in ${m.q.getRemainingSeconds(e.arrivalSeconds)} seconds...`):(p.refetchHeroes(),clearInterval(t))}),1e3);return`<button class="btn btn-warning disabled" id="${n}" data-record_id="${e.hero_record_id}" type="button">Arrives in ${m.q.getRemainingSeconds(e.arrivalSeconds)} seconds...</button>`}return 0!==e.is_available||m.q.stillInAdventure(e.arrivalSeconds)?` <button class="btn btn-warning sendHeroBtn" data-record_id="${e.hero_record_id}" type="button">Send</button>`:`<button class="btn btn-warning claimHeroBtn" data-record_id="${e.hero_record_id}" type="button">Claim Bounty</button>`})(t)}\n        </div>\n    </div>`;var t})).join("")),e.heroesContainer.insertAdjacentHTML("beforeend",'<div class="single-hero-box col-lg-3 col-md-6 col-sm-12" id="addHeroBtn"><div class="hero-box-inner-details h-100"><i class="bi bi-plus-square" style="font-size: 3em;color: #ffc107;"></i></div></div>')},HeroHtml:{heroTraderHTML:e=>`<div class="single-hero-box col-md-4">\n                <div class="hero-box-inner-details">\n                    <img src='${e.image}' class="img-thumbnail"/>\n                    <p>${e.name}</p>\n                </div>\n                <div class="d-grid gap-2 mt-2">\n                    <button class="btn btn-warning buyHeroBtn" data-hero_id="${e.id}"><i class="bi bi-coin"></i> ${e.price}</button>\n                </div>\n            </div>`}}}(),y=function(e){const{item:t,gold:n}=e,o=[];n&&o.push(function(e){return`<p>Your hero brought ${e} <i class="bi bi-coin"></i></p>`}(n)),t&&o.push(C.ItemsHtml.singleItem(t,!0)),t||n||o.push("<h4>Your Hero didn't bring anything...<h4>"),a.u_.clearModal(),a.u_.populateModal("Your Bounty",o.join(""),'<button class="btn btn-warning" id="okayBtn">Okay</button>'),a.u_.show()},v=function(e){let t,n,o;t=e.name,n=C.ItemsHtml.itemInfoHTML(e),o='<button class="btn btn-warning" id="okayBtn">Okay</button>',a.u_.clearModal(),a.u_.populateModal(t,n,'<button class="btn btn-warning" id="okayBtn">Okay</button>'),a.u_.show()},w=async function(){let e,t,n;e='<div class="d-flex flex-row">Trader <i style="margin-left: 10px" id="reloadTraderItemsBtn" class="bi bi-arrow-clockwise"></i></div>';const o=await u(3),r=await s(3),i=o.map((e=>C.ItemsHtml.itemTraderHTML(e))).join("");t=`\n            <div id="traderHeroes" class="row">${r.map((e=>g.HeroHtml.heroTraderHTML(e))).join("")}</div>\n            <div id="traderItems" class="row mt-3">${i}</div>\n        `,n='<button class="btn btn-warning" id="okayBtn">Okay</button>',a.u_.clearModal(),a.u_.populateModal('<div class="d-flex flex-row">Trader <i style="margin-left: 10px" id="reloadTraderItemsBtn" class="bi bi-arrow-clockwise"></i></div>',t,'<button class="btn btn-warning" id="okayBtn">Okay</button>'),a.u_.show()},_=async function(e){const t=a.u_.isOpened();a.u_.clearModal(),a.u_.populateModal("Error",`${e}`,"",!1),!t&&a.u_.show(),setTimeout(a.u_.hideAndClear,1500)},M=function(){a.u_.clearModal(),a.u_.populateModal("Welcome User!",'\n            <h3>Helpful Tips</h3>\n            <p class="mt-3 mb-0"><i class="bi bi-box-arrow-left" style="font-size:1.6em"></i> for logout.</p>\n            <p class="mb-0"><i class="bi bi-wrench" style="font-size:1.6em"></i> to edit your username.</p>\n            <p class="mb-0"><i class="bi bi-trash" style="font-size:1.6em"></i> to delete your account.</p>\n            <p class="mb-0"><i class="bi bi-coin" style="font-size:1.6em"></i> as a local currency.</p>\n            <p class="mb-0"><i class="bi bi-info-circle" style="font-size:1.6em"></i> for item information.</p>\n            <p class="mb-0 mt-5">Go ahead and have an adventure with your Hero!</p>\n        \n        ',""),a.u_.show()};var B=n(8563);const C=function(){const e={itemsContainer:document.getElementById("items-container")},t={singleItem:({image:e,story:t,rarity:n,price:o,record_id:a},r=!1,i=null)=>r?`<div class="col-lg-4 col-sm-6 mb-4">\n                <div class="${n} single-item-box p-4">\n                    <img src='${e}' class="img-thumbnail"/>\n                </div>\n            </div>`:`\n            <div class="col-lg-3 col-md-6 mb-4">\n                <div class="${n} single-item-box p-4">\n                    <img src='${e}' class="img-thumbnail"/>\n                    <p><i>${t?t.substr(0,50):"no story"}...</i></p>\n                    <div class="d-flex justify-content-between">\n                        <button class="btn btn-warning showItemInfoBtn" data-local_arr_idx="${i}">\n                            <i class="bi bi-info-circle"></i>\n                        </button>\n                        <button class="btn btn-warning sellItemBtn" data-local_arr_idx="${i}"  title="Sell">\n                            ${o} <i class="bi bi-coin"></i>\n                        </button>\n                    </div>\n                </div>\n            </div>`,itemInfoHTML:({image:e,desc:t,rarity:n,price:o,record_id:a})=>` \n                <div class="row p-4">\n                    <div class="col-md-4 d-flex justify-content-center align-items-center">\n                        <img src='${e}' class="img-thumbnail"/>\n                    </div>\n                    <div class="col-md-8 d-flex justify-content-center flex-column">\n                        <p><i>${t}...</i></p>\n                        <p>Rarity: ${n} </br> Price: ${o} <i class="bi bi-coin"></i></p>\n                    </div>\n                </div>`,itemTraderHTML:({image:e,desc:t,rarity:n,price:o,id:a})=>` \n                <div class="col-md-4 d-flex flex-column justify-content-center">\n                    <img src='${e}' class="img-thumbnail"/>\n                    <p>Rarity: ${n} </br> Price: ${o} <i class="bi bi-coin"></i></p>\n                    <button class="btn btn-warning buyItemBtn" data-record_id="${a}"><i class="bi bi-cart2"></i></button>\n                </div>\n            `,itemsContainer:e=>`${e.join("\n")}`};return{ItemsHtml:t,displayItems:function(n){e.itemsContainer.innerHTML="";const o=n.map(((e,n)=>t.singleItem(e,!1,n)));e.itemsContainer.insertAdjacentHTML("beforeend",t.itemsContainer(o))},showItemInfo:function(e){let t=void 0===B(B(e.target).parent()).data("local_arr_idx")?B(B(e.target)).data("local_arr_idx"):B(B(e.target).parent()).data("local_arr_idx"),n=a.Kr.get().items[t];v(n)}}}();var I=n(8563);const T=async function(e){const t=await u(3),n=await s(3);I("#traderItems").html(t.map((e=>C.ItemsHtml.itemTraderHTML(e))).join("")),I("#traderHeroes").html(n.map((e=>g.HeroHtml.heroTraderHTML(e))).join(""))},H=async function(e){e.preventDefault(),w()};var j=n(8563);const $=async function(e){const{profile:t}=a.Kr.get(),n={user_id:t.id,hero_record_id:j(e.target).data("record_id")};await r(n),p.refetchHeroes()},x=async function(e){const{profile:t}=a.Kr.get(),n={user_id:t.id,hero_record_id:j(e.target).data("record_id")},o=await i(n);o.success&&(y(o.data),p.reload())},k=async function(e){const t=j(e.target).data("hero_id")?j(e.target).data("hero_id"):j(j(e.target).parent()).data("hero_id"),{success:n}=await l(t);n?(a.u_.hideAndClear(),p.reload()):_("Not enough money!")},S=async function(e){await w()};var O=n(8563);const E=async function(e){let t=void 0===O(O(e.target).parent()).data("local_arr_idx")?O(O(e.target)).data("local_arr_idx"):O(O(e.target).parent()).data("local_arr_idx");const n=a.Kr.get().items[t],{db_id:o,record_id:r}=n,i={db_id:o,record_id:r};(await c(i)).success||console.error("Error on the back when selling item!"),p.refetchItems(),p.refetchProfile()},P=async function(e){const t=O(e.target).data("record_id")?O(e.target).data("record_id"):O(O(e.target).parent()).data("record_id");await d(t),a.u_.hideAndClear(),p.refetchItems(),p.refetchProfile()},A=async function(){const e=await fetch("/profile",{method:"DELETE",mode:"cors",cache:"no-cache",credentials:"same-origin",referrerPolicy:"no-referrer"});return await e.json()},L=async function(e){return(await fetch("/profile",{method:"PUT",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},referrerPolicy:"no-referrer",body:JSON.stringify(e)})).json()},N=async function(e){const t={newUsername:h.getUsername()},n=a.Kr.get().profile.username,o=await L(t);if(o.error)return _(o.error),void h.setUsername(n);a.Kr.set({profile:o})},K=async function(e){e.preventDefault();const t=await A();document.location.href=t.redirectUrl};var U=n(8563);!function(){const e={logoutBtn:document.getElementById("logoutBtn"),updateBtn:document.getElementById("updateBtn"),deleteBtn:document.getElementById("deleteBtn"),traderBtn:U("#traderBtn")};e.logoutBtn.addEventListener("click",a.QD.logout),e.updateBtn.addEventListener("click",N),e.deleteBtn.addEventListener("click",K),U("body").on("click","button.sendHeroBtn",$),U("body").on("click","button.claimHeroBtn",x),U("body").on("click","button.buyHeroBtn",k),U("body").on("click","#addHeroBtn",S),U("body").on("click","button.showItemInfoBtn",C.showItemInfo),U("body").on("click","button.sellItemBtn",E),U("body").on("click","button.buyItemBtn",P),e.traderBtn.on("click",H),U("body").on("click","#reloadTraderItemsBtn",T),U("body").on("click","#okayBtn",a.u_.hideAndClear)}(),a.Kr.subscribe(p.stateChanged,p),async function(){o.Z.load(),p.reload(),null===localStorage.getItem("first_time")&&(M(),localStorage.setItem("first_time","false"))}()}},e=>{e.O(0,[563,652],(()=>(4814,e(e.s=4814)))),e.O()}]);